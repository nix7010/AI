<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI業務改善パートナー | はじめてのAI活用を1時間で前進</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap');

        :root {
            --primary-color: #0066FF;
            --secondary-color: #00AA55;
            --text-dark: #1a1a1a;
            --text-light: #666;
            --bg-light: #f8faff;
            --bg-very-light: #e8f2ff;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Noto Sans JP', sans-serif;
            line-height: 1.7; color: var(--text-dark);
            overflow-x: hidden; background-color: var(--bg-light);
        }
        /* header */
        .header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0,0,0,0.05);
            padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center;
        }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); }
        .nav-links { display: flex; gap: 1.5rem; }
        .nav-links a {
            text-decoration: none; color: var(--text-dark); font-weight: 500; position: relative; transition: color .3s ease;
        }
        .nav-links a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -5px; left: 50%; transform: translateX(-50%); background-color: var(--primary-color); transition: width .3s ease; }
        .nav-links a:hover { color: var(--primary-color); }
        .nav-links a:hover::after { width: 100%; }
        .cta-btn {
            padding: .75rem 1.5rem; border-radius: 25px; text-decoration: none; font-weight: 700; border: none; cursor: pointer;
            background: linear-gradient(135deg, var(--primary-color), #0052cc); color: #fff; box-shadow: 0 4px 15px rgba(0,102,255,0.2);
            transition: all .3s ease;
        }
        .cta-btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 8px 25px rgba(0,102,255,0.3); }
        .main-content { margin-top: 75px; }
        /* hero */
        .hero { min-height: calc(100vh - 75px); display: flex; align-items: center; position: relative; background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-very-light) 100%); overflow: hidden; }
        .hero-content { max-width: 1200px; margin: 0 auto; padding: 2rem; display: grid; grid-template-columns: 1.2fr 1fr; gap: 4rem; align-items: center; }
        .hero-text h1 { font-size: 3.1rem; font-weight: 900; line-height: 1.3; margin-bottom: 1.25rem; }
        .hero-text .highlight { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-text p { font-size: 1.2rem; color: var(--text-light); margin-bottom: 2rem; }
        .hero-image { display: flex; justify-content: center; align-items: center; }
        .hero-svg { width: 100%; max-width: 500px; height: auto; animation: float 6s ease-in-out infinite; }
        /* section base */
        .section { padding: 6rem 2rem; max-width: 1200px; margin: 0 auto; opacity: 0; transform: translateY(30px); transition: opacity .8s ease, transform .8s ease; }
        .section.visible { opacity: 1; transform: translateY(0); }
        .section-title { font-size: 2.4rem; font-weight: 700; text-align: center; margin-bottom: 1rem; }
        .section-subtitle { font-size: 1.1rem; text-align: center; color: var(--text-light); margin-bottom: 3rem; max-width: 720px; margin-left: auto; margin-right: auto; }
        /* features */
        .features { background: #fff; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .feature-card { background: #fff; border-radius: 20px; padding: 2.2rem; box-shadow: 0 10px 40px rgba(0,0,0,0.08); transition: all .3s ease; border-top: 4px solid var(--primary-color); }
        .feature-card:hover { transform: translateY(-10px); box-shadow: 0 20px 60px rgba(0,102,255,0.15); }
        .feature-icon { width: 60px; height: 60px; margin-bottom: 1.1rem; color: var(--primary-color); }
        .feature-card h3 { font-size: 1.25rem; font-weight: 700; margin-bottom: .5rem; }
        .feature-card .target { font-weight: 700; color: var(--primary-color); display: block; margin-bottom: .5rem; }
        /* profile */
        .profile { background: #fff; display: flex; align-items: center; gap: 4rem; flex-wrap: wrap; }
        .profile-image { flex: 1; min-width: 250px; text-align: center; }
        .profile-image img { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; box-shadow: 0 10px 40px rgba(0,102,255,0.2); }
        .profile-text { flex: 2; min-width: 300px; }
        .profile-text .greeting { font-size: 1.25rem; font-weight: 700; margin-bottom: 1.25rem; line-height: 1.5; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .profile-text p { margin-bottom: 1.2rem; color: var(--text-light); }
        .profile-text .name { font-size: 1.1rem; font-weight: 700; text-align: right; }
        /* examples */
        .examples { background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-very-light) 100%); }
        .example-card { background: #fff; border-radius: 20px; padding: 2.2rem; box-shadow: 0 10px 40px rgba(0,0,0,0.08); display: grid; grid-template-columns: 1fr auto; gap: 2rem; align-items: center; transition: all .3s ease; border-left: 5px solid var(--secondary-color); }
        .example-card:hover { transform: translateX(10px); box-shadow: 0 20px 60px rgba(0,102,255,0.15); }
        .example-result { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: #fff; padding: 1.1rem 2rem; border-radius: 15px; font-weight: 700; text-align: center; min-width: 180px; }
        .example-result .number-container { font-size: 2rem; display: block; font-weight: 900; }
        .example-result .unit { font-size: 1rem; }
        /* process */
        .process { background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-very-light) 100%); }
        .process-steps { display: flex; justify-content: space-between; align-items: flex-start; position: relative; }
        .process-steps::before { content: ''; position: absolute; top: 30px; left: 12.5%; right: 12.5%; height: 2px; background: linear-gradient(to right, var(--primary-color), var(--secondary-color)); opacity: .3; }
        .process-step { text-align: center; width: 25%; position: relative; }
        .step-number { width: 60px; height: 60px; border-radius: 50%; background: #fff; color: var(--primary-color); display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: 700; margin: 0 auto 1rem; border: 2px solid var(--primary-color); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        /* cta */
        .cta-section { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: #fff; text-align: center; position: relative; padding: 5rem 2rem 14rem; padding-bottom: calc(5rem + env(safe-area-inset-bottom, 0px)); }
.cta-section .cta-btn { margin-top: 1.75rem; margin-bottom: 1rem; display: inline-block; }
        /* footer */
        .footer { background: #1a1a1a; color: #aaa; padding: 3rem 2rem 2rem; text-align: center; }
        /* anim */
        @keyframes float { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-20px)} }
        /* responsive */
        @media (max-width: 992px){
            .hero-content{ grid-template-columns:1fr; text-align:center; }
            .hero-text h1{ font-size: 2.6rem; }
            .hero-svg{ max-width: 400px; margin-top: 2rem; }
            .profile{ text-align:center; }
            .profile-text .name{ text-align:center; }
            .nav-links{ display:none; }
        }
        @media (max-width: 768px){
            .section{ padding: 4rem 1.5rem; }
            .section-title{ font-size: 2rem; }
            .header{ padding: 1rem; }
            .process-steps{ flex-direction: column; gap: 2.5rem; align-items: center; }
            .process-step{ width: 80%; }
            .process-steps::before{ display:none; }
            .example-card{ grid-template-columns: 1fr; text-align: center; }
        }
    </style>
<style>@media (max-width:768px){#gformIframe{height:60vh !important;} .cta-section{padding-bottom: calc(18rem + env(safe-area-inset-bottom, 0px));}}</style>
</head>
<body>
<header class="header">
    <div class="logo">AI Partner</div>
    <nav class="nav-links">
        <a href="#features">提供サービス</a>
        <a href="#profile">ご挨拶</a>
        <a href="#examples">導入事例</a>
        <!-- お客様の声リンクは削除 -->
    </nav>
    <a href="https://forms.gle/kYNQD6itFuARB5th8" class="cta-btn" onclick="return openContactForm(event)">1時間の無料相談</a>
</header>

<main class="main-content">
    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <div class="hero-text">
                <h1>
                    面倒な定型業務はAIに任せて、<br />
                    <span class="highlight">“売上に直結する仕事”</span>に時間を取り戻しませんか？
                </h1>
                <p>
                    はじめてでも大丈夫。現場目線でAI活用を設計し、<br />
                    無理なく続く仕組みに落とし込みます。
                </p>
                <a href="https://forms.gle/kYNQD6itFuARB5th8" class="cta-btn" onclick="return openContactForm(event)">今すぐ <strong>1時間</strong> 無料相談</a>
            </div>
            <div class="hero-image">
                <svg class="hero-svg" viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <defs>
                        <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:var(--primary-color);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:var(--secondary-color);stop-opacity:1" />
                        </linearGradient>
                    </defs>
                    <circle cx="250" cy="250" r="240" fill="rgba(255,255,255,0.5)" />
                    <circle cx="250" cy="250" r="220" fill="url(#grad1)" opacity="0.1" />
                    <g transform="translate(150, 150)">
                        <path d="M 50,0 A 50,50 0 1,1 50,100 L 150,100 A 50,50 0 1,1 150,0 Z" fill="url(#grad1)" opacity="0.2"/>
                        <rect x="20" y="20" width="160" height="160" rx="20" fill="white" />
                        <path d="M 50 50 L 150 50 L 150 150 L 50 150 Z" fill="none" stroke="var(--primary-color)" stroke-width="5" />
                        <circle cx="100" cy="100" r="20" fill="var(--secondary-color)" />
                    </g>
                </svg>
            </div>
        </div>
    </section>

    <!-- Features -->
    <section class="section features" id="features">
        <h2 class="section-title">AIによる業務改善ソリューション</h2>
        <p class="section-subtitle">
            「どこから手を付ければ良い？」に答える、現場密着のサービスラインナップです。
        </p>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"/></svg>
                </div>
                <h3>文書作成・要約</h3>
                <p><span class="target">議事録・稟議・報告書の速度を底上げ</span>自然言語で指示→精度の高いドラフトを即生成。レビューに集中できます。</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"/></svg>
                </div>
                <h3>問い合わせ対応</h3>
                <p><span class="target">24時間の一次対応を自動化</span>FAQボット/フォーム連携/社内ナレッジ検索まで一気通貫で設計します。</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h12A2.25 2.25 0 0020.25 14.25V3M3.75 21h16.5M16.5 3.75h.008v.008h-.008V3.75z"/></svg>
                </div>
                <h3>データ分析</h3>
                <p><span class="target">意思決定を“勘”から“根拠”へ</span>売上/顧客/在庫データを自動集計し、見える化＆週次レポートを標準化。</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 01-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 013.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 013.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 01-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.562L16.25 22.5l-.648-1.938a3.375 3.375 0 00-2.694-2.694L11.25 18l1.938-.648a3.375 3.375 0 002.694-2.694L16.25 13.5l.648 1.938a3.375 3.375 0 002.694 2.694L21.75 18l-1.938.648a3.375 3.375 0 00-2.694 2.694z"/></svg>
                </div>
                <h3>業務自動化</h3>
                <p><span class="target">“手作業ゼロ”の状態へ段階移行</span>定型作業をAI＋連携ツールで自動化し、ヒューマンエラーも削減します。</p>
            </div>
            <!-- ★ 追加: あなた専用のGPTs・Gemを作成 -->
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m6-6H6"/></svg>
                </div>
                <h3>あなた専用のGPTs・Gemを作成</h3>
                <p><span class="target">社内向け“使えるAI”を短期構築</span>役割・口調・社内ルール・ナレッジを組み込んだ専用AI（GPTs/Gem）を設計・実装。<br />業務フローに合わせて権限や入出力形式も最適化します。</p>
            </div>
            <!-- ★ 追加: AI活用教育 -->
            <div class="feature-card">
                <div class="feature-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 14l9-5-9-5-9 5 9 5zm0 0v7"/></svg>
                </div>
                <h3>AI活用教育</h3>
                <p><span class="target">現場が“明日から回せる”研修</span>基本操作からプロンプト作法、情報セキュリティ、運用ルール作りまで。部門別ワークで定着を支援します。</p>
            </div>
        </div>
    </section>

    <!-- Profile -->
    <section class="section profile" id="profile">
        <div class="profile-image">
            <!-- 顔写真に差し替えてください -->
            <img src="MY selfy.jpg" alt="コンサルタントの顔写真" />
        </div>
        <div class="profile-text">
            <h2 class="section-title" style="text-align:left;">ご挨拶</h2>
            <p class="greeting">AIを“道具”ではなく“仕組み”に。　成果に直結する運用まで伴走します。</p>
            <p>はじめまして。AI業務改善パートナーの齋藤です。最新技術の導入はゴールではありません。貴社の課題に合わせて設計し、現場で回る形に落とし込む。これが私の役目です。</p>
            <p>まずは現状と理想のギャップを1時間で整理し、すぐに試せる打ち手をご提案します。小さく始めて、大きく効かせる。共に前進しましょう。</p>
            <p class="name">AI業務改善パートナー 齋藤 直人</p>
        </div>
    </section>

    <!-- Examples (一般事例のまま) -->
    <section class="section examples" id="examples">
        <h2 class="section-title">AI導入による業務効率化の一般事例</h2>
        <p class="section-subtitle">大手企業を中心に、AI活用は成果を上げています。※下記は公開情報に基づく一般的な事例です。</p>
        <div class="examples-grid">
            <div class="example-card">
                <div class="example-content">
                    <h3>三菱UFJ銀行</h3>
                    <p>社内文書・稟議の作成効率が向上し、対顧客業務に注力可能に。</p>
                </div>
                <div class="example-result" data-target="22" data-suffix="万時間削減"><span class="number-container">0</span><span class="unit">万時間削減</span></div>
            </div>
            <div class="example-card">
                <div class="example-content">
                    <h3>セブン-イレブン</h3>
                    <p>販売データ/SNS分析の活用で新商品企画のリードタイム短縮。</p>
                </div>
                <div class="example-result" data-target="90" data-suffix="%短縮"><span class="number-container">0</span><span class="unit">%短縮</span></div>
            </div>
            <div class="example-card">
                <div class="example-content">
                    <h3>住友化学</h3>
                    <p>全社で改良版チャット活用。文書作成と分析業務の高効率化。</p>
                </div>
                <div class="example-result" data-target="50" data-suffix="%効率化"><span class="number-container">0</span><span class="unit">%効率化</span></div>
            </div>
        </div>
    </section>

    <!-- Process -->
    <section class="section process" id="process">
        <h2 class="section-title">導入までの流れ</h2>
        <div class="process-steps">
            <div class="process-step">
                <div class="step-number">1</div>
                <h4>初回相談（無料）</h4>
                <p>1時間ヒアリング<br />課題の棚卸し</p>
            </div>
            <div class="process-step">
                <div class="step-number">2</div>
                <h4>業務分析とご提案</h4>
                <p>現状診断<br />最適なAIプラン設計</p>
            </div>
            <div class="process-step">
                <div class="step-number">3</div>
                <h4>導入・設計</h4>
                <p>ツール設定<br />業務フロー構築</p>
            </div>
            <div class="process-step">
                <div class="step-number">4</div>
                <h4>運用サポート</h4>
                <p>効果測定<br />継続的な改善</p>
            </div>
        </div>
    </section>

    <!-- CTA -->
    <section class="cta-section" id="contact">
        <h2>まずは <strong>1時間の無料相談</strong> から</h2>
        <p>現状ヒアリング → つまずきの特定 → “明日からできる”改善案までを1時間で整理します。<br />強引な営業は一切ありません。お気軽にどうぞ。</p>
        <a href="https://forms.gle/kYNQD6itFuARB5th8" class="cta-btn" onclick="return openContactForm(event)">無料相談を申し込む</a>
    </section>
</main>

<footer class="footer">
    <p>&copy; 2025 AI業務改善パートナー. All rights reserved.</p>
</footer>

<!-- Contact Modal -->
<div id="contactModal" style="display:none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center;">
    <div id="modalContent" style="background-color: #fff; margin: auto; padding: 2rem 3rem; border-radius: 20px; max-width: 500px; width: 90%; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transform: scale(0.9); opacity: 0; transition: all 0.3s ease;">
        <span id="closeModal" style="color: #aaa; position: absolute; top: 1rem; right: 1.5rem; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
        <div style="padding: 0;">
            <div style="padding: 1.25rem 1.5rem; border-bottom: 1px solid #eee;">
                <h3 style="color: var(--primary-color); margin: 0 0 .25rem; font-size: 1.6rem; text-align: center;">1時間の無料相談フォーム</h3>
                <p style="text-align:center; color:#666; font-size:.95rem; margin:0;">うまく表示されない場合は <a href="https://forms.gle/kYNQD6itFuARB5th8" target="_blank" rel="noopener">こちら</a> から直接開いてください。</p>
            </div>
            <iframe id="gformIframe" title="相談フォーム" src="" style="width:100%; height:75vh; border:0; display:block;"></iframe>
        </div>
    </div>
</div>

<script>
    // === Config ===
    var FORM_DIRECT_URL = 'https://forms.gle/kYNQD6itFuARB5th8';
    var FORM_EMBED_URL = 'https://docs.google.com/forms/d/e/1FAIpQLSdR_fK5g-q0Zg1oqyupwXZYmGzAqWp-oCcClxPe-aOZesflQQ/viewform?embedded=true';

    // Googleフォーム 事前入力のエントリID（提供いただいたURLから抽出済み）
    var PREFILL = {
        name:  'entry.873810222',     // お名前
        topic: 'entry.1784100519',    // 相談区分/件名
        time:  'entry.1954219580'     // 希望日時
    };

    // 任意のデフォルト値（URLやdata属性が無いときに使用）
    var DEFAULT_PREFILL_NAME = '';

    // === Helpers ===
    function getPrefillSuffix(triggerEl){
        try{
            var url = new URL(location.href);
            var sp = url.searchParams;
            var name  = (triggerEl && triggerEl.dataset && triggerEl.dataset.prefillName)  || sp.get('prefill_name')  || sp.get('name')  || localStorage.getItem('prefill_name')  || DEFAULT_PREFILL_NAME || '';
            var topic = (triggerEl && triggerEl.dataset && triggerEl.dataset.prefillTopic) || sp.get('prefill_topic') || sp.get('topic') || '';
            var time  = (triggerEl && triggerEl.dataset && triggerEl.dataset.prefillTime)  || sp.get('prefill_time')  || sp.get('time')  || '';
            var params = new URLSearchParams();
            if (PREFILL.name && name)  params.append(PREFILL.name,  name);
            if (PREFILL.topic && topic) params.append(PREFILL.topic, topic);
            if (PREFILL.time && time)  params.append(PREFILL.time,  time);
            var s = params.toString();
            return s ? ('&' + s) : '';
        } catch(e){
            return '';
        }
    }

    function bindIframeAutoClose(iframe, modal, modalContent){
        if (!iframe || iframe.dataset.bound === '1') return;
        iframe.dataset.bound = '1';
        iframe.dataset.loads = '0';
        iframe.addEventListener('load', function(){
            var loads = parseInt(iframe.dataset.loads || '0', 10) + 1;
            iframe.dataset.loads = String(loads);
            // 1回目: フォーム表示, 2回目: 送信後のサンクス画面表示（推定）
            if (loads >= 2){
                setTimeout(function(){
                    if (typeof window.closeModal === 'function') {
                        window.closeModal();
                    } else if (modal && modalContent){
                        modalContent.style.transform = 'scale(0.9)';
                        modalContent.style.opacity = '0';
                        setTimeout(function(){ modal.style.display = 'none'; }, 300);
                    }
                }, 800);
            }
        });
    }

    // --- Global function (used by inline onclick) ---
    function openContactForm(event) {
        if (event) event.preventDefault();
        var modal = document.getElementById('contactModal');
        var modalContent = document.getElementById('modalContent');
        var iframe = document.getElementById('gformIframe');
        if (iframe){
            // プレフィルを付与して毎回リロード
            var suffix = getPrefillSuffix(event ? event.currentTarget : null);
            iframe.src = FORM_EMBED_URL + suffix;
            iframe.dataset.loads = '0';
            bindIframeAutoClose(iframe, modal, modalContent);
        }
        if (modal && modalContent) {
            modal.style.display = 'flex';
            setTimeout(function(){ modalContent.style.transform = 'scale(1)'; modalContent.style.opacity = '1'; }, 10);
        }
        return false; // prevent default navigation
    }

    document.addEventListener('DOMContentLoaded', function(){
        // section reveal
        var observer = new IntersectionObserver(function(entries){
            entries.forEach(function(entry){ if (entry.isIntersecting) entry.target.classList.add('visible'); });
        }, { threshold: 0.1 });
        document.querySelectorAll('.section').forEach(function(section){ observer.observe(section); });

        // number animation
        function animateNumber(el){
            var target = +el.dataset.target; var duration = 2000; var stepTime = 20; var current = 0;
            var steps = duration / stepTime; var increment = target / steps; var numberContainer = el.querySelector('.number-container');
            var timer = setInterval(function(){ current += increment; if (current >= target){ clearInterval(timer); current = target; } numberContainer.textContent = Math.floor(current); }, stepTime);
        }
        var numberObserver = new IntersectionObserver(function(entries, ob){
            entries.forEach(function(entry){ if (entry.isIntersecting){ animateNumber(entry.target); ob.unobserve(entry.target); } });
        }, { threshold: 0.5 });
        document.querySelectorAll('.example-result').forEach(function(el){ numberObserver.observe(el); });

        // modal
        var modal = document.getElementById('contactModal');
        var modalContent = document.getElementById('modalContent');
        var closeModalBtn = document.getElementById('closeModal');
        function closeModal(){
            modalContent.style.transform = 'scale(0.9)';
            modalContent.style.opacity = '0';
            setTimeout(function(){ modal.style.display = 'none'; }, 300);
        }
        window.closeModal = closeModal;
        closeModalBtn.onclick = closeModal;
        modal.onclick = function(e){ if (e.target === modal) closeModal(); };
        document.addEventListener('keydown', function(e){ if (e.key === 'Escape') closeModal(); });

        // --- Smoke & behavior tests (run with #test in URL) ---
        function runSmokeTests(){
            try {
                console.assert(typeof window.openContactForm === 'function', 'openContactForm should be defined');
                console.assert(document.getElementById('gformIframe'), 'gformIframe should exist');
                console.assert(document.getElementById('contactModal'), 'contactModal should exist');
                console.log('[SmokeTest] DOM OK');

                // Test: prefill suffix building with dataset
                var dummy = document.createElement('a');
                dummy.dataset.prefillName = '山田太郎';
                dummy.dataset.prefillTopic = 'AI相談';
                dummy.dataset.prefillTime = '2025-09-14（日） 11:37–12:37';
                var suffix = getPrefillSuffix(dummy);
                console.assert(suffix.includes('entry.873810222'), 'name id should be present');
                console.assert(suffix.includes('entry.1784100519'), 'topic id should be present');
                console.assert(suffix.includes('entry.1954219580'), 'time id should be present');

                // Test: openContactForm sets iframe src
                var iframe = document.getElementById('gformIframe');
                iframe.src = '';
                openContactForm();
                console.assert(iframe.src && iframe.src.indexOf('docs.google.com/forms') !== -1, 'iframe src should be set to Google Forms');

                // Test: auto close after two loads (simulate)
                setTimeout(function(){
                    iframe.dispatchEvent(new Event('load'));
                    iframe.dispatchEvent(new Event('load'));
                    setTimeout(function(){
                        console.assert(modal.style.display === 'none', 'Modal should auto-close after two loads');
                        console.log('[SmokeTest] Auto-close simulated OK');
                    }, 1400);
                }, 200);

                // Test: mobile CSS rule injected
                var hasRule = Array.from(document.styleSheets).some(function(ss){
                    try { return Array.from(ss.cssRules || []).some(function(r){ return (r.cssText || '').indexOf('#gformIframe') !== -1; }); } catch(e){ return false; }
                });
                console.assert(hasRule, 'Mobile 60vh rule should be present');
                // Test: CTA padding-bottom is large enough to avoid footer overlap
                var cta = document.querySelector('.cta-section');
                var pb = parseInt(window.getComputedStyle(cta).paddingBottom, 10);
                console.assert(pb >= 140, 'CTA padding-bottom should be >= 140px to avoid overlap');
            } catch (err) {
                console.error('[SmokeTest] failed:', err);
            }
        }
        if (location.hash.indexOf('test') !== -1) runSmokeTests();
    });
</script>
</body>
</html>
